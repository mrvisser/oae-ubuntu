require(["jquery","oae.core"],function(e,t){var n="d:"+e.url().segment(2)+":"+e.url().segment(3),r=null,i=function(){t.api.discussion.getDiscussion(n,function(e,n){if(e){e.code===401?t.api.util.redirect().accessdenied():t.api.util.redirect().notfound();return}r=n,t.api.util.setBrowserTitle(r.displayName),o(),u(),s(),t.api.util.showPage()})},s=function(){e(document).on("oae.context.get",function(t,n){n?e(document).trigger("oae.context.send."+n,r):e(document).trigger("oae.context.send",r)}),e(document).trigger("oae.context.send",r)},o=function(){t.api.util.template().render(e("#discussion-clip-template"),{discussion:r},e("#discussion-clip-container")),t.data.me.anon||t.api.util.template().render(e("#discussion-actions-clip-template"),{discussion:r},e("#discussion-actions-clip-container"))},u=function(){if(r.description){var n=t.api.util.security().encodeForHTML(r.description).replace(/\n/g,"<br/>");e("#discussion-topic").html(n),e("#discussion-topic-container").show()}},a=function(){return{contextProfile:r,messages:{accessNotUpdatedBody:t.api.i18n.translate("__MSG__DISCUSSION_ACCESS_COULD_NOT_BE_UPDATED__"),accessNotUpdatedTitle:t.api.i18n.translate("__MSG__DISCUSSION_ACCESS_NOT_UPDATED__"),accessUpdatedBody:t.api.i18n.translate("__MSG__DISCUSSION_ACCESS_SUCCESSFULLY_UPDATED__"),accessUpdatedTitle:t.api.i18n.translate("__MSG__DISCUSSION_ACCESS_UPDATED__"),membersTitle:t.api.i18n.translate("__MSG__SHARE_WITH__"),"private":t.api.i18n.translate("__MSG__PRIVATE__"),loggedin:t.api.util.security().encodeForHTML(r.tenant.displayName),"public":t.api.i18n.translate("__MSG__PUBLIC__"),privateDescription:t.api.i18n.translate("__MSG__DISCUSSION_PRIVATE_DESCRIPTION__"),loggedinDescription:t.api.i18n.translate("__MSG__DISCUSSION_LOGGEDIN_DESCRIPTION__",null,{tenant:t.api.util.security().encodeForHTML(r.tenant.displayName)}),publicDescription:t.api.i18n.translate("__MSG__DISCUSSION_PUBLIC_DESCRIPTION__")},roles:{member:t.api.i18n.translate("__MSG__CAN_VIEW__"),manager:t.api.i18n.translate("__MSG__CAN_MANAGE__")},api:{getMembersURL:"/api/discussion/"+r.id+"/members",setMembers:t.api.discussion.updateMembers,setVisibility:t.api.discussion.updateDiscussion}}};e(document).on("click",".discussion-trigger-manageaccess",function(){e(document).trigger("oae.trigger.manageaccess",a())}),e(document).on("oae.manageaccess.done",function(e){o()}),e(document).on("oae.editdiscussion.done",function(e,t){t.canShare=r.canShare,t.canPost=r.canPost,t.isManager=r.isManager,r=t,o(),u()}),i()});