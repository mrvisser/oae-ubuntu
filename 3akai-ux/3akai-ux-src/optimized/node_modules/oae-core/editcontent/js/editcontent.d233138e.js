define(["jquery","oae.core"],function(e,t){return function(n){var r=e("#"+n),i=null,s=function(){e("#editcontent-modal",r).on("hidden",function(n){var i=e("#editcontent-form",r);i[0].reset(),t.api.util.validation().clear(i),e("#editcontent-form *",r).prop("disabled",!1)})},o=function(){t.api.util.template().render(e("#editcontent-template",r),{content:i},e(".modal-body",r));var n={submitHandler:u};t.api.util.validation().validate(e("#editcontent-form",r),n)},u=function(){e("#editcontent-form *",r).prop("disabled",!0);var n={displayName:e.trim(e("#editcontent-name",r).val()),description:e.trim(e("#editcontent-description",r).val())};return i.resourceSubType==="link"&&(n.link=e.trim(e("#editcontent-link",r).val())),t.api.content.updateContent(i.id,n,function(n,s){var o=t.api.util.template().render(e("#editcontent-notification-template"),{content:i,err:n});n?(t.api.util.notification(t.api.i18n.translate("__MSG__DETAILS_NOT_EDITED__","editcontent"),o,"error"),e("#editcontent-form *",r).prop("disabled",!1)):(e("#editcontent-modal",r).modal("hide"),t.api.util.notification(t.api.i18n.translate("__MSG__DETAILS_EDITED__","editcontent"),o),e(document).trigger("oae.editcontent.done",s))}),!1},a=function(){e(document).on("click",".oae-trigger-editcontent",function(){e("#editcontent-modal",r).modal({backdrop:"static"}),e(document).trigger("oae.context.get","editcontent")}),e(document).on("oae.context.send.editcontent",function(e,t){i=t,o()}),e("#editcontent-modal",r).on("shown",function(){e("#editcontent-name",r).focus()})};s(),a()}});