define(["jquery","oae.core"],function(e,t){return function(n){var r=e("#"+n),i=null,s=function(){e("#editdiscussion-modal",r).on("hidden",function(n){var i=e("#editdiscussion-form",r);i[0].reset(),t.api.util.validation().clear(i),e("#editdiscussion-form *",r).prop("disabled",!1)})},o=function(){t.api.util.template().render(e("#editdiscussion-template",r),{discussion:i},e(".modal-body",r));var n={submitHandler:u};t.api.util.validation().validate(e("#editdiscussion-form",r),n)},u=function(){e("#editdiscussion-form *",r).prop("disabled",!0);var n={displayName:e.trim(e("#editdiscussion-name",r).val()),description:e.trim(e("#editdiscussion-topic",r).val())};return t.api.discussion.updateDiscussion(i.id,n,function(n,i){n?(t.api.util.notification(t.api.i18n.translate("__MSG__DISCUSSION_NOT_EDITED__","editdiscussion"),t.api.i18n.translate("__MSG__DISCUSSION_EDIT_FAIL__","editdiscussion"),"error"),e("#editdiscussion-form *",r).prop("disabled",!1)):(e("#editdiscussion-modal",r).modal("hide"),t.api.util.notification(t.api.i18n.translate("__MSG__DISCUSSION_EDITED__","editdiscussion"),t.api.i18n.translate("__MSG__DISCUSSION_EDIT_SUCCESS__","editdiscussion")),e(document).trigger("oae.editdiscussion.done",i))}),!1},a=function(){e(document).on("click",".oae-trigger-editdiscussion",function(){e("#editdiscussion-modal",r).modal({backdrop:"static"}),e(document).trigger("oae.context.get","editdiscussion")}),e(document).on("oae.context.send.editdiscussion",function(e,t){i=t,o()}),e("#editdiscussion-modal",r).on("shown",function(){e("#editdiscussion-name",r).focus()})};s(),a()}});